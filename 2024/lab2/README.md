## Лабораторная работа № 2
### Машинное обучение на больших данных с использованием фреймворка Apache Spark и библиотеки SparkML
#### Цель работы:
* Обучить и провалидировать распространённые модели машинного обучения с использованием датасета большого объёма.

#### Задачи работы:
1. Познакомиться с особенностями обучения моделей ML на данных большого объема.
2. Получить представление о реализации основных этапов машинного обучения в библиотеке `SparkML`.
3. Познакомиться с организацией подготовки признаков, обучения и валидации модели как воспроизводимого конвейера.
4. Получить навыки создания программного кода на `pyspark` для проведения основных этапов машинного обучения.
5. Научиться анализировать качество модели, обученной на больших данных.

#### Порядок выполнения работы:
1. Соединитесь с кластером, зайдите на `hadoop-node` и войдите в свою локальную директорию по инструкции, рассмотренной в лабораторной работе № 1. В локальной директории с Вашим именем должна располагаться папка с проектом лабораторных работ, полученная при выполнении первой лабораторной работы.
2. Обновите репозиторий с лабораторными работами:

```
git pull
```
3. На левой панели `VS Code` нажмите на кнопку `Open Folder` и перейдите в директорию со второй лабораторной работой.
4. Откройте файлы `Jupyter Notebook` (*.ipynb), выберите виртуальное окружение `pyspark-env` и поочерёдно запустите инструкции в файлах на исполнение. Некоторые инструкции потребуют модификации информации о запустившем их пользователе, не пропустите их. Проанализируйте содержание ноутбуков.

5. **Проведите аналогичным образом обучение и валидацию моделей машинного обучения с датасетом, выбранным Вами для первой лабораторной работы.**
* В работе должно быть рассмотрено решение двух задач: регрессии и бинарной классификации. Формулировка соответствующих задач определяется содержанием выбранного датасета и выполняется студентом самостоятельно.
* Для решения данных задач следует использовать модели **в соответствии с вариантом**:

| `Номер студента в группе` mod 4 | Модель регрессии      | Модель бинарной классификации |
| ------------------------------- | --------------------- | ----------------------------- |
| 0                               | LinearRegression      | RandomForestClassifier        |
| 1                               | LinearRegression      | GBTClassifier                 |
| 2                               | RandomForestRegressor | LogisticRegression            |
| 3                               | GBTRegressor          | LogisticRegression            |

* Если в датасете отсутствует бинарный признак, который можно рассматривать в качестве целевой переменной в задаче бинарной классификации, то можно самостоятельно сделать его из одного из количественных, бинаризовав этот признак по некоторому выбранному порогу.
* Для обученных моделей должны быть получены и проанализированы метрики, оценивающие их качество.
* Небольшую часть датасета следует сохранить в формате `csv` для использования в следующей лабораторной работе.
* Одну из обученных моделей нужно сохранить в `HDFS` для использования в следующей лабораторной работе.

6. Сделайте выводы по работе.
7. Напишите **главу курсовой работы** в пределах **15-20 страниц**, в которой опишите постановку задач машинного обучения, подготовку данных, формирование ML-конвейера, подбор гиперпараметров, обучение модели, её валидацию, расчет метрик и выводы.
8. Сохраните ноутбук с проведенным анализом и написанную главу курсовой в `GitHub / GitLab`.

**К отчету** следует представить репозиторий на `GitHub / GitLab` с оформленными ноутбуками и главой курсовой работы, а также быть готовым продемонстрировать работоспособность кода и пояснить спорные моменты.

#### Список теоретических вопросов к отчету:

### Список впросов будет пополняться и изменяться после лекций!

1. Основные понятия машинного обучения. Задачи обучения с учителем и без учителя. Принцип минимума эмпирического риска.
2. Понятие градиента. Градиентные методы обучения, их преимущества и недостатки.
3. Обработка количественных и категориальных признаков. Способы кодирования категориальных признаков.
4. Библиотека `SparkML`. Понятие трансформеров, эстиматоров, конвейеров и связь между ними. Примеры.
5. Понятие обобщающей способности модели и её контроль. Переобучение и способы борьбы с ним. Кросс-валидация.
6. Задачи регрессии и классификации. Классификация на несбалансированных выборках, реализация в `pyspark`.
7. Модель линейной регрессии. Регуляризация линейной регресии. Алгоритм линейной регрессии на больших данных.
8. Модель логистической регрессии. Регуляризация логистической регресии. Алгоритм логистической регрессии на больших данных.
9. Модель деревьев решений, обучение дерева решений.
10. Ансамбли модели ML. Random Forest и GBM, их реализация в `SparkML`.

#### Литература для подготовки к отчету:
1. Изучаем Spark: молниеносный анализ данных / Х. Карау, Э. Конвински, П. Венделл, М.М. Захария // ДМК Пресс, 2015. — 304 с.: ил.
2. Учебник по машинному обучению [Электронный  ресурс]. – [2024]. – Режим доступа : https://education.yandex.ru/handbook/ml (дата обращ. 13.10.2024)
3. Официальный сайт Apache Spark [Электронный  ресурс]. – [2024]. – Режим доступа : https://spark.apache.org/ (дата обращ. 13.10.2024).
4. Перрен, Ж.-Ж. Spark в действии / Ж.-Ж. Перрен ; перевод с английского А. В. Снастина. — Москва : ДМК Пресс, 2021. — 636 с.
